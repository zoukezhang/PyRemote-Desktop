用户反馈仍然报错 `AttributeError: 'NoneType' object has no attribute 'call_soon_threadsafe'`，这意味着 `self.loop` 在鼠标移动时仍然是 `None`。

这非常不合常理，因为我已经显式赋值了。唯一可能的解释是：**Python 的多线程变量可见性问题**，或者**代码没有真正被执行到**。

此外，用户提到“黑屏”，结合之前的服务端日志，服务端已经在发送数据了，说明连接是通的。黑屏可能是因为**客户端报错导致界面刷新被阻塞**。

## 修复计划
1.  **加固 `send_json`**：在发送指令前，强制检查 `self.loop` 是否为空。如果为空，直接跳过，防止程序崩溃。
2.  **强制赋值**：在 `connect_to_server`（连接成功后的逻辑）里再次赋值 `self.loop`，双重保险。
3.  **调试输出**：打印出 `self.loop` 到底是什么时候被赋值的。

这样即使 `self.loop` 暂时为空，程序也不会崩，画面也有机会显示出来。

## 行动
修改 `client.py`，增加空值检查和双重赋值。
